(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["attendance~common~csmstimetable~educationAffairs~infoPublic~operationalAnalysis "],{"3d36":function(e,t,a){var s=a("a1a8");t=s(!1),t.push([e.i,".select-teacher-org[data-v-176a006f]{position:relative;top:20px;bottom:20px}.select-teacher-org .center-serch-wrap[data-v-176a006f]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:10px}.select-teacher-org .center-serch-wrap .casader-search[data-v-176a006f]{width:300px}",""]),e.exports=t},afa3:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{staticClass:"select-teacher-org",attrs:{styles:{top:"20px",width:"90%"},title:e.modalTitle,transfer:!1,closable:!1,"mask-closable":!1},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("Row",{staticClass:"cascader-content"},[a("i-col",{staticClass:"cascader-content-left",attrs:{span:"16"}},[a("div",{staticClass:"cascader-content-left-search"},[a("Alert",{attrs:{"show-icon":""}},[e._v("点击左侧栏组织，中间栏勾选用户，右侧栏显示已选用户。")]),a("i-input",{staticClass:"casader-search",staticStyle:{width:"300px"},attrs:{search:"","enter-button":"",placeholder:"请输入姓名/用户名"},on:{"on-search":e.searchNameFun},model:{value:e.modalSearchName,callback:function(t){e.modalSearchName=t},expression:"modalSearchName"}},[a("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend"},on:{"on-change":e.changeSearchType},slot:"prepend",model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[a("Option",{attrs:{value:"1"}},[e._v("局部")]),a("Option",{attrs:{value:"2"}},[e._v("全局")])],1)],1)],1),a("Row",[a("i-col",{staticClass:"cascader-content-left",attrs:{span:"8"}},[a("Tree",{staticClass:"tree-list",attrs:{data:e.newList,"load-data":e.newLoadData},on:{"on-select-change":e.treeSelect}})],1),a("i-col",{staticClass:"cascader-content-center",attrs:{span:"16"}},[a("div",{staticClass:"center-serch-wrap"},[e.transferData.length>1&&""===e.modalSearchName&&"1"===e.isSearchType&&"全选"!==e.transferData[0].label||"2"===e.isSearchType&&e.transferData.length>1?a("checkbox",{on:{"on-change":e.checkAllBtn},model:{value:e.casaderIsAll,callback:function(t){e.casaderIsAll=t},expression:"casaderIsAll"}},[e._v("全选")]):e._e()],1),0===e.transferData.length?a("Alert",{staticStyle:{margin:"0px 0px 20px"},attrs:{type:"warning","show-icon":""}},[e._v(" 未查询到相关信息 "),a("template",{slot:"desc"},[e._v(" 当前分组下暂无信息，请切换分组后重新查找。 ")])],2):a("div",e._l(e.transferData,(function(t){return a("div",{key:t.childNameStr},[t.memberlist.length>0?a("div",{staticClass:"cascader-content-center-list"},[a("div",{staticClass:"cascader-content-center-list-border"},[""===e.modalSearchName||"2"===e.isSearchType?a("checkbox",{key:t.value,attrs:{size:"large"},on:{"on-change":function(a){return e.handleCheckAll(t)}},model:{value:t.CheckAll,callback:function(a){e.$set(t,"CheckAll",a)},expression:"item.CheckAll"}},[e._v(e._s(t.label)+" ")]):a("span",[e._v(e._s(t.label))])],1),e._l(t.memberlist,(function(s){return["2"===e.isSearchType||"1"===e.isSearchType&&(s.FullName.indexOf(e.modalSearchName)>=0||""==e.modalSearchName||s.UserName.indexOf(e.modalSearchName)>=0)?a("checkbox",{key:s.UserID,staticClass:"check-name",attrs:{size:"large",title:s.UserName},on:{"on-change":function(a){return e.checkAllChange(s,t)}},model:{value:s.singleCheck,callback:function(t){e.$set(s,"singleCheck",t)},expression:"child.singleCheck"}},[e._v(" "+e._s(s.FullName)+" ")]):e._e()]}))],2):e._e()])})),0)],1)],1)],1),a("i-col",{staticClass:"cascader-content-right",attrs:{span:"8"}},[a("div",{staticClass:"title"},[e._v("已选"),a("b",[e._v(e._s(e.checkAllList.length))]),e._v("人")]),a("div",{staticClass:"cascader-content-right-list"},e._l(e.checkAllList,(function(t){return a("Tag",{key:t.UserName,staticClass:"checked-list",attrs:{name:t.UserID,closable:"",title:t.UserName},on:{"on-close":e.handleClose}},[e._v(e._s(t.FullName)+" ")])})),1)])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{staticClass:"xy-modal-close",on:{click:e.modalCancel}},[e._v("取消")]),a("Button",{staticClass:"xy-modal-primary",attrs:{shape:"circle"},on:{click:e.modalConfirm}},[e._v("确定")])],1)],1)},r=[],l=(a("fe59"),a("ecb4"),a("2eeb"),a("ea69"),a("e18c"),a("34d9"),a("96db"),a("08ba"),a("af86"),a("5748")),i=a("5412"),n=a.n(i),c=(a("b449"),a("cf7f")),h={name:"SelectTeacherOrg",props:{isRequiredSelect:{type:Boolean,default:!0},isShowSelectAll:{type:Boolean,default:!0},modalTitle:{type:String,default:"选择教师"},isShow:{type:Boolean,required:!0},teachers:{type:Array,required:!0}},data:function(){return{searchType:"1",isSearchType:"1",showModal:!1,modalSearchName:"",casaderIsAll:!1,isLoadingShow:!0,newList:[],transferData:[],checkAllList:[],checkAllGroup:[],isDataList:!1}},created:function(){},watch:{isShow:function(e){this.showModal=e,e&&this.openAddModal()}},methods:{modalCancel:function(){this.casaderIsAll=!1,this.newList=[],this.transferData=[],this.checkAllGroup=[],this.checkAllList=[],this.modalSearchName="",this.searchType="1",this.isSearchType="1",this.$emit("select-cancel")},modalConfirm:function(){this.isRequiredSelect?this.checkAllList.length>0?(this.modalSearchName="",this.searchType="1",this.isSearchType="1",this.$emit("select-confirm",this.checkAllList)):this.xy.msgError("请先选择教师。"):(this.modalSearchName="",this.$emit("select-confirm",this.checkAllList))},openAddModal:function(){var e=this;return Object(c["a"])(n.a.mark((function t(){var a,s,r;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.newList=[],e.transferData=[],e.checkAllList=[],e.casaderIsAll=!1,a={id:0,type:""},e.xy.loading(),t.next=8,e.xy.get(e.xyApi+"/xy/comm/GetNodeList",a);case 8:if(s=t.sent,s.success&&s.data.length>0)for(r=0;r<s.data.length;r++)0===s.data[r].value?e.newList.push({title:s.data[r].label,id:s.data[r].value,nodetype:s.data[r].nodetype}):e.newList.push({title:s.data[r].label,loading:!1,children:[],id:s.data[r].value,nodetype:s.data[r].nodetype});e.xy.unloading(),e.isLoadingShow=!1;case 12:case"end":return t.stop()}}),t)})))()},newLoadData:function(e,t){var a=this;return Object(c["a"])(n.a.mark((function s(){var r,l,i;return n.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a.isLoadingShow=!0,r={id:e.id,type:e.nodetype},s.next=4,a.xy.get(a.xyApi+"/xy/comm/GetNodeList",r);case 4:l=s.sent,i=[],l.success&&(l.data.forEach((function(t){t.ischild?i.push({parentId:e.id,parentTitle:e.title,parentNodetype:e.nodetype,id:t.value,title:t.label,loading:!1,nodetype:t.nodetype,children:[]}):i.push({parentId:e.id,parentTitle:e.title,parentNodetype:e.nodetype,id:t.value,title:t.label,nodetype:t.nodetype})})),t(i)),a.isLoadingShow=!1;case 8:case"end":return s.stop()}}),s)})))()},treeSelect:function(e){e.length>0&&("S"!==e[0].nodetype?this.getTeachers(e):(this.isLoadingShow=!0,this.transferData=[],this.getTeachers2(e)))},getTeachers:function(e){var t=this;return Object(c["a"])(n.a.mark((function a(){var s,r,l,i,c,h,o,m,f;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.xy.loading(),s={orgID:e[0].id,teacherIDs:"",type:e[0].nodetype},t.isLoadingShow=!0,a.next=5,t.xy.get(t.xyApi+"/xy/comm/GetNodeListHasmember",s);case 5:if(r=a.sent,t.transferData=[],r.success)if(r.data.length>0){for(l=0;l<r.data.length;l++)if(r.data[l].CheckAll=!1,r.data[l].checkAllGroup=[],r.data[l].memberlist.length>0){for(t.isDataList=!1,i=0;i<r.data[l].memberlist.length;i++)r.data[l].memberlist[i].singleCheck=!1,r.data[l].childNameStr+=r.data[l].memberlist[i].FullName+","+r.data[l].memberlist[i].UserName+",";t.transferData.push(r.data[l])}if(t.checkAllList.length>0)for(c=0;c<t.transferData.length;c++){for(h=0;h<t.transferData[c].memberlist.length;h++)o=t.checkAllList.map((function(e){return e.UserID})).indexOf(t.transferData[c].memberlist[h].UserID),-1!==o&&(t.transferData[c].memberlist[h].singleCheck=!0);m=t.transferData[c].memberlist.map((function(e){return e.singleCheck})).indexOf(!0),-1===m?(t.transferData[c].CheckAll=!1,t.casaderIsAll=!1):(f=t.transferData[c].memberlist.map((function(e){return e.singleCheck})).indexOf(!1),-1===f?(t.transferData[c].CheckAll=!0,t.casaderIsAll=!0):(t.transferData[c].CheckAll=!1,t.casaderIsAll=!1))}}else t.isDataList=!0;else t.isDataList=!0;t.isLoadingShow=!1,t.xy.unloading();case 10:case"end":return a.stop()}}),a)})))()},getTeachers2:function(e){var t=this;return Object(c["a"])(n.a.mark((function a(){var s,r,l,i,c,h,o,m,f,d;return n.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.xy.loading(),s={orgID:0,schoolID:e[0].id},t.isLoadingShow=!0,a.next=5,t.xy.get(t.xyApi+"/xy/comm/GetOrganizationMember",s);case 5:if(r=a.sent,r.success){if(r.data.length>0){for(l=r.data,i=0;i<l.length;i++)for(l[i].IsCurrent=!1,l[i].ischild=!1,l[i].loading=!1,l[i].CheckAll=!1,l[i].label=l[i].Name,l[i].memberlist=l[i].Members,l[i].value=l[i].OrganizationID,c=0;c<l[i].memberlist.length;c++)l[i].memberlist[c].FullName=l[i].memberlist[c].Name,l[i].memberlist[c].UserID=l[i].memberlist[c].ID,l[i].memberlist[c].singleCheck=!1,l[i].childNameStr+=l[i].memberlist[c].FullName+","+l[i].memberlist[c].UserName+",";t.transferData=l}if(t.checkAllList.length>0)for(h=0;h<t.transferData.length;h++){for(o=0;o<t.transferData[h].memberlist.length;o++)m=t.checkAllList.map((function(e){return e.UserID})).indexOf(t.transferData[h].memberlist[o].UserID),-1!==m&&(t.transferData[h].memberlist[o].singleCheck=!0);f=t.transferData[h].memberlist.map((function(e){return e.singleCheck})).indexOf(!0),-1===f?t.transferData[h].CheckAll=!1:(d=t.transferData[h].memberlist.map((function(e){return e.singleCheck})).indexOf(!1),t.transferData[h].CheckAll=-1===d)}}t.isLoadingShow=!1,t.xy.unloading();case 9:case"end":return a.stop()}}),a)})))()},checkAllBtn:function(){if(this.casaderIsAll){for(var e=0;e<this.transferData.length;e++){this.transferData[e].CheckAll=!0;for(var t=0;t<this.transferData[e].memberlist.length;t++)this.transferData[e].memberlist[t].singleCheck=!0,this.checkAllList.push(this.transferData[e].memberlist[t])}this.checkDuplicateRemoval(this.checkAllList)}else for(var a=0;a<this.transferData.length;a++){this.transferData[a].CheckAll=!1;for(var s=0;s<this.transferData[a].memberlist.length;s++){this.transferData[a].memberlist[s].singleCheck=!1;for(var r=0;r<this.checkAllList.length;r++)this.checkAllList[r].UserID===this.transferData[a].memberlist[s].UserID&&this.checkAllList.splice(r,1)}}},checkDuplicateRemoval:function(e){var t=this,a=e.map((function(e){return e.UserID}));a=Object(l["a"])(new Set(a)),this.checkAllList=[],e.forEach((function(e){a.indexOf(e.UserID)>-1&&(a.splice(a.indexOf(e.UserID),1),t.checkAllList.push(e))}))},handleCheckAll:function(e){if(e.CheckAll){e.memberlist.map((function(e){return e.singleCheck=!0}));for(var t=0;t<this.transferData.length;t++){for(var a=0;a<this.transferData[t].memberlist.length;a++){for(var s=0;s<e.memberlist.length;s++)this.transferData[t].memberlist[a].UserID===e.memberlist[s].UserID&&(this.transferData[t].memberlist[a].singleCheck=!0);this.transferData[t].memberlist[a].singleCheck&&this.checkAllList.push(this.transferData[t].memberlist[a])}var r=this.transferData[t].memberlist.map((function(e){return e.singleCheck})).indexOf(!1);this.transferData[t].CheckAll=-1===r}this.checkDuplicateRemoval(this.checkAllList)}else for(var l=0;l<this.transferData.length;l++){for(var i=0;i<this.transferData[l].memberlist.length;i++){var n=e.memberlist.map((function(e){return e.UserID})).indexOf(this.transferData[l].memberlist[i].UserID);-1!==n&&(this.transferData[l].memberlist[i].singleCheck=!1)}for(var c=0;c<e.memberlist.length;c++){var h=this.checkAllList.map((function(e){return e.UserID})).indexOf(e.memberlist[c].UserID);-1!==h&&this.checkAllList.splice(h,1)}var o=this.transferData[l].memberlist.map((function(e){return e.singleCheck})).indexOf(!0);if(-1===o)this.transferData[l].CheckAll=!1,this.casaderIsAll=!1;else{var m=this.transferData[l].memberlist.map((function(e){return e.singleCheck})).indexOf(!1);-1===m?(this.transferData[l].CheckAll=!0,this.casaderIsAll=!0):(this.transferData[l].CheckAll=!1,this.casaderIsAll=!1)}}var f=this.transferData.map((function(e){return e.CheckAll})).indexOf(!1);this.casaderIsAll=-1===f},checkAllChange:function(e){if(e.singleCheck){this.checkAllList.push(e);for(var t=[],a=0;a<this.transferData.length;a++){var s=this.transferData[a].memberlist.map((function(e){return e.UserID})).indexOf(e.UserID);-1!==s&&(this.transferData[a].memberlist[s].singleCheck=!0);var r=this.transferData[a].memberlist.map((function(e){return e.singleCheck})).indexOf(!1);-1===r?(this.transferData[a].CheckAll=!0,t.push(!0)):t.push(!1)}}else{var l=this.checkAllList.map((function(e){return e.UserID})).indexOf(e.UserID);this.checkAllList.splice(l,1);for(var i=0;i<this.transferData.length;i++){var n=this.transferData[i].memberlist.map((function(e){return e.UserID})).indexOf(e.UserID);-1!==n&&(this.transferData[i].memberlist[n].singleCheck=!1);var c=this.transferData[i].memberlist.map((function(e){return e.singleCheck})).indexOf(!0);if(-1===c)this.transferData[i].CheckAll=!1;else{var h=this.transferData[i].memberlist.map((function(e){return e.singleCheck})).indexOf(!1);this.transferData[i].CheckAll=-1===h}}}var o=this.transferData.map((function(e){return e.CheckAll})).indexOf(!1);this.casaderIsAll=-1===o},searchNameFun:function(e){"1"===this.searchType?this.modalSearchName=e:""!==this.modalSearchName?this.allSearch():this.xy.msgError("请输入要搜索的用户。")},changeSearchType:function(e){this.searchType=e,this.isSearchType=e},allSearch:function(){var e=this;this.xy.loading(),this.xy.get("".concat(this.xyApi,"/base/api/Users/FuzzySearch"),{word:this.modalSearchName,userRoleType:2}).then((function(t){if(e.isLoadingShow=!0,e.transferData=[],t.success)if(t.data.length>0){e.isDataList=!1,e.transferData=[{label:"全选",CheckAll:!1,checkAllGroup:[],memberlist:[]}];for(var a=0;a<t.data.length;a++)e.transferData[0].memberlist.push({FullName:t.data[a].FullName,UserName:t.data[a].UserName,UserID:t.data[a].UserID,SchoolCardNumber:t.data[a].SchoolCardNumber,singleCheck:!1,childNameStr:t.data[a].FullName+","+t.data[a].UserName+","});if(console.log(e.transferData),e.checkAllList.length>0)for(var s=0;s<e.transferData.length;s++){for(var r=0;r<e.transferData[s].memberlist.length;r++){var l=e.checkAllList.map((function(e){return e.UserID})).indexOf(e.transferData[s].memberlist[r].UserID);-1!==l&&(e.transferData[s].memberlist[r].singleCheck=!0)}var i=e.transferData[s].memberlist.map((function(e){return e.singleCheck})).indexOf(!0);if(-1===i)e.transferData[s].CheckAll=!1,e.casaderIsAll=!1;else{var n=e.transferData[s].memberlist.map((function(e){return e.singleCheck})).indexOf(!1);-1===n?(e.transferData[s].CheckAll=!0,e.casaderIsAll=!0):(e.transferData[s].CheckAll=!1,e.casaderIsAll=!1)}}}else e.isDataList=!0;else e.isDataList=!0;e.isLoadingShow=!1,e.xy.unloading()}))},handleClose:function(e,t){for(var a=0;a<this.checkAllList.length;a++)this.checkAllList[a].UserID===t&&this.checkAllList.splice(a,1);this.changeSelectValid(t)},changeSelectValid:function(e){for(var t=0;t<this.transferData.length;t++){var a=this.transferData[t].memberlist.map((function(e){return e.UserID})).indexOf(e);-1!==a&&(this.transferData[t].memberlist[a].singleCheck=!1);var s=this.transferData[t].memberlist.map((function(e){return e.singleCheck})).indexOf(!0);if(-1===s)this.transferData[t].CheckAll=!1,this.casaderIsAll=!1;else{var r=this.transferData[t].memberlist.map((function(e){return e.singleCheck})).indexOf(!1);-1===r?(this.transferData[t].CheckAll=!0,this.casaderIsAll=!0):(this.transferData[t].CheckAll=!1,this.casaderIsAll=!1)}}}}},o=h,m=(a("f6e3"),a("9ca4")),f=Object(m["a"])(o,s,r,!1,null,"176a006f",null);t["a"]=f.exports},bee2:function(e,t,a){var s=a("3d36");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var r=a("85cb").default;r("f8e17b90",s,!0,{sourceMap:!1,shadowMode:!1})},f6e3:function(e,t,a){"use strict";var s=a("bee2"),r=a.n(s);r.a}}]);